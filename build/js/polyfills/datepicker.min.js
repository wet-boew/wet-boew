/*!
 *
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-eng.txt / wet-boew.github.io/wet-boew/Licence-fra.txt
 *
 * Version: @wet-boew-build.version@
 *
 */
!function(a){"use strict";var b;a.fn.datepicker=function(){return a(this).each(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o=pe.fn.calendar,p=new Date,q="YYYY-MM-DD",r=p.getMonth(),s=p.getFullYear(),t=pe.dic.get("%datepicker-show"),u=pe.dic.get("%datepicker-hide"),v=pe.dic.get("%interword-space"),w=pe.dic.get("%datepicker-selected"),x=a(this);x.hasClass("picker-field")||(x.addClass("picker-field"),e=function(c){var d=a('label[for="'+c+'"]').text(),e=a('<a id="'+c+'-picker-toggle" class="picker-toggle-hidden wb-invisible" href="javascript:;"><img class="image-actual" src="'+pe.add.liblocation+'images/datepicker/calendar-month.png" alt="'+t+v+d+'"/></a>');e.on("click vclick touchstart",function(){return n(c),!1}),x.after(e),b.slideUp(0),setTimeout(function(){e.removeClass("wb-invisible")},10)},c=function(b,c,e,f,g,h,i){var j,k,o=a("#"+b);g=void 0!==o.attr("min")?o.attr("min"):"1800-01-01",h=void 0!==o.attr("max")?o.attr("max"):"2100-01-01",g=pe.date.from_iso_format(g),h=pe.date.from_iso_format(h),j=c===g.getFullYear()&&e===g.getMonth(),k=c===h.getFullYear()&&e===h.getMonth(),f.each(function(o,p){if(!j&&!k||j===!0&&o>=g.getDate()||k===!0&&o<=h.getDate()){var q=a(p).children("div"),r=a('<a href="javascript:;"></a>'),s=q.parent();s.empty(),r.append(q.html()),r.appendTo(s),r.on("keydown",function(d){var f=a(this).closest(".cal-container"),i=f.attr("id");if(d.ctrlKey||d.altKey||d.metaKey){if(d.ctrlKey&&!d.altKey&&!d.metaKey)switch(d.keyCode){case 35:return l(i,c,e,g,h,new Date(c,11,31)),!1;case 36:return l(i,c,e,g,h,new Date(c,0,1)),!1}}else switch(d.keyCode){case 27:return n(b),!1;case 32:return a(this).trigger("click"),!1;case 33:return d.shiftKey?l(i,c,e,g,h,new Date(c-1,e,o+1)):l(i,c,e,g,h,new Date(c,e-1,o+1)),!1;case 34:return d.shiftKey?l(i,c,e,g,h,new Date(c+1,e,o+1)):l(i,c,e,g,h,new Date(c,e+1,o+1)),!1;case 35:return pe.focus(a(this).closest("ol").children("li").children("a").last()),!1;case 36:return pe.focus(a(this).closest("ol").children("li").children("a").first()),!1;case 37:return l(i,c,e,g,h,new Date(c,e,o)),!1;case 38:return l(i,c,e,g,h,new Date(c,e,o-6)),!1;case 39:return l(i,c,e,g,h,new Date(c,e,o+2)),!1;case 40:return l(i,c,e,g,h,new Date(c,e,o+8)),!1}}),r.on("click vclick touchstart",{fieldid:b,year:c,month:e,day:o+1,days:f,format:i},function(b){var c=a("#"+b.data.fieldid),e=c.val();return d(b.data.fieldid,b.data.year,b.data.month+1,b.data.day,b.data.format),e!==c.val()&&c.trigger("change"),m(b.data.fieldid,b.data.year,b.data.month,b.data.days,b.data.format),n(b.data.fieldid),!1})}})},l=function(a,c,d,e,f,g){g.getTime()<e.getTime()?(g=e,g.setDate(g.getDate()+1)):g.getTime()>f.getTime()&&(g=f,g.setDate(g.getDate()+1)),(g.getMonth()!==d||g.getFullYear()!==c)&&o.create(a,g.getFullYear(),g.getMonth(),!0,e,f),pe.focus(b.find(".cal-day-list").children("li:eq("+(g.getDate()-1)+")").children("a"))},m=function(b,c,d,e,f){var g,h,i,j;a(e).removeClass("datepicker-selected"),a(e).find(".datepicker-selected-text").detach(),f=f.replace("DD","(?<a> [0-9]{2})"),f=f.replace("D","(?<a> [0-9] )"),f=f.replace("MM","(?<b> [0-9]{2})"),f=f.replace("M","(?<b> [0-9])"),f=f.replace("YYYY","(?<c> [0-9]{4})"),f=f.replace("YY","(?<c /> [0-9]{2})"),g="^"+f+"$",h=a("#"+b).val(),j=new XRegExp(g,"x");try{""!==h&&(i=a.parseJSON(h.replace(j,'{"year":"$1", "month":"$2", "day":"$3"}')),parseInt(i.year,10)===c&&parseInt(i.month,10)===d+1&&(a(e[i.day-1]).addClass("datepicker-selected"),a(e[i.day-1]).children("a").append('<span class="wb-invisible datepicker-selected-text"> ['+w+"]</span>")))}catch(k){}},d=function(a,c,d,e,g){b.parent().find("#"+a).val(f(c,d,e,g))},n=function(c){var d=a("#"+c),e=d.parent(),f=e.find("#"+c+"-picker-toggle"),m=pe.date.from_iso_format(d.val());f.toggleClass("picker-toggle-hidden picker-toggle-visible"),k=void 0!==d.attr("min")?d.attr("min"):"1800-01-01",j=void 0!==d.attr("max")?d.attr("max"):"2100-01-01",b.attr({"aria-labelledby":c+"-picker-toggle","aria-controls":c}),o.create("wb-picker",s,r,!0,k,j),d.after(b),b.unbind("focusout.calendar"),b.unbind("focusin.calendar"),f.hasClass("picker-toggle-visible")?(h(c),b.find("a").attr("tabindex",0),b.slideDown("fast",function(){i(a(this))}),b.attr("aria-hidden","false"),f.children("a").children("span").text(u),null!==m?(m.setDate(m.getDate()+1),l("wb-picker",s,r,pe.date.from_iso_format(k),pe.date.from_iso_format(j),m)):0!==b.find(".cal-prevmonth a").length?pe.focus(b.find(".cal-prevmonth a")):0!==b.find(".cal-nextmonth a").length?pe.focus(b.find(".cal-nextmonth a")):pe.focus(b.find(".cal-goto a"))):(g(a("#"+c)),pe.focus(e.find("#"+c)))},h=function(b){a(".picker-field").each(function(){a(this).attr("id")!==b&&g(a(this))})},g=function(c){var d,e,f;d=c.attr("id"),e=a("#"+d+"-picker-toggle"),f=a('label[for="'+d+'"]').text(),b.find("a").attr("tabindex","-1"),b.slideUp("fast",function(){i(a(this))}),b.attr("aria-hidden","true"),o.hideGoToForm("wb-picker"),e.children("a").children("span").text(t+v+f),e.removeClass("picker-toggle-visible"),e.addClass("picker-toggle-hidden")},i=function(b){var c,d=a("#wb-main-in");7===pe.ie?(c=b.height()+b.offset().top-d.offset().top+50,d.height()>=c?d.css("min-height",""):d.height()<c&&d.css("min-height",c)):pe.ie>0&&pe.ie<7&&(c=b.height()+b.offset().top-d.offset().top+50,d.height()>=c?d.css("height",""):d.height()<c&&d.css("height",c))},f=function(a,b,c,d){var e=d;return e=e.replace("DD",pe.string.pad(c,2)),e=e.replace("D",c),e=e.replace("MM",pe.string.pad(b,2)),e=e.replace("M",b),e=e.replace("YYYY",a),e=e.replace("YY",a.toString().substr(2,2))},void 0===b&&(b=a('<div id="wb-picker" class="picker-overlay" role="dialog" aria-hidden="true"></div>'),b.on("keyup",function(a){27===a.keyCode&&(h(),pe.focus(b.parent().find("#"+b.attr("aria-controls"))))}),b.on("calendarDisplayed",function(b,d,e,f){var g=a(this),h=g.attr("aria-controls");c(h,d,e,f,k,j,q),m(h,d,e,f,q),g.on("click vclick touchstart focusin",function(a){a.stopPropagation?a.stopImmediatePropagation():a.cancelBubble=!0})}),pe.document.on("click vclick touchstart focusin",function(){return"false"===b.attr("aria-hidden")?(g(b.parent().find("#"+b.attr("aria-controls"))),!1):void 0}),a('<a class="picker-close" role="button" href="javascript:;"><img src="'+pe.add.liblocation+'images/datepicker/cross-button.png" alt="'+u+'" class="image-actual" /></a>').appendTo(b).click(function(){n(b.attr("aria-controls"))}),b.find("a").attr("tabindex","-1"),pe.bodydiv.after(b)),void 0!==x.attr("id")&&e(x.attr("id")))})},a('input[type="date"]').datepicker()}(jQuery);