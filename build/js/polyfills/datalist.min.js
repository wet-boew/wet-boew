/*!
 *
 * Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
 * wet-boew.github.io/wet-boew/License-eng.txt / wet-boew.github.io/wet-boew/Licence-fra.txt
 *
 * Version: @wet-boew-build.version@
 *
 */
!function(a){"use strict";a.fn.datalist=function(){return a(this).each(function(b){var c,d,e,f,g,h,i=a(this),j=this.id,k=j+"-label",l=pe.main.find("label").filter("[for="+j+"]"),m=a("#"+i.attr("list")),n=[];0!==l.length&&l.attr("id",k),e=function(b){var e,f;0!==b.length?(e=b.toLowerCase(),f=d.filter(function(){var b=a(this),c=b.find("span.al-value").html();return 0===c.length&&(c=b.find("span.al-label").html()),0===e.length||-1!==c.toLowerCase().indexOf(e)})):f=d,c.empty().append(f),0!==f.length?(g(),c.removeClass("al-hide"),i.attr("aria-expanded","true")):(c.addClass("al-hide"),i.attr("aria-expanded","false"))},f=function(){c.addClass("al-hide").empty(),i.attr({"aria-expanded":"false","aria-activedescendent":""})},g=function(){c.css("width",i.innerWidth()),pe.ie>0&&pe.ie<8&&c.css("top",i.innerHeight()+13)},pe.resize(g),m.find("option").each(function(c){var d=a(this),e=d.attr("value"),f=d.attr("label");"undefined"===e&&(e=d.text()),n.push('<li class="al-option" id="al-option-'+b+"-"+c+'"><a href="javascript:;"><span class="al-value">'+("undefined"!==e?e:"")+'</span><span class="al-label">'+("undefined"!==f?f:"")+"</span></a></li>")}),i.attr({autocomplete:"off",role:"textbox","aria-haspopup":"true","aria-autocomplete":"list","aria-owns":"wb-autolist-"+b,"aria-activedescendent":""}).wrap('<div class="wb-al-container" role="application" aria-'+(0!==l.length?'labelledby="'+k:'-label="'+i.attr("title"))+'"/>'),h=i.parent(),c=a('<ul role="listbox" id="wb-autolist-'+b+'" class="wb-autolist al-hide" aria-hidden="true" aria-live="polite"></ul>'),d=a(n.join("")),i.after(c),i.on("keyup keydown click vclick touchstart focus",function(a){var b,d=a.type,g=a.keyCode;if("keyup"===d)a.ctrlKey||a.altKey||a.metaKey||(g>47&&58>g||g>64&&91>g||32===g||8===g)&&e(i.val());else if("keydown"===d){if(!a.ctrlKey&&!a.metaKey)if(a.altKey||c.hasClass("al-hide")){if(38===g||40===g)return e(""),!1}else{if(27===g)return f(),!1;if((38===g||40===g)&&""===i.attr("aria-activedescendent"))return b=38===g?c.find("a").last():c.find("a").eq(0),i.attr("aria-activedescendent",b.parent().attr("id")),pe.focus(b),!1}}else{if("click"===d||"vclick"===d)return c.hasClass("al-hide")||f(),!1;"focus"===d&&pe.ie>0&&pe.ie<8&&c.addClass("al-hide").empty()}}),c.on("keyup keydown click vclick touchstart","a, span",function(b){var d,g,h,j,k=b.type,l=b.keyCode,m=a(b.target),n=i.val();if("keyup"===k)b.ctrlKey||b.altKey||b.metaKey||(l>47&&58>l||l>64&&91>l||32===l?(i.val(n+String.fromCharCode(l)),pe.focus(i),e(i.val())):8===l&&(i.val().length>0&&(i.val(n.substring(0,n.length-1)),e(i.val())),pe.focus(i)));else if("keydown"===k){if(!(b.ctrlKey||b.altKey||b.metaKey)){if(13===l)return j=m.find("span.al-value").html(),0===j.length&&(j=m.find("span.al-label").html()),i.val(j),pe.focus(i),f(),!1;if(9===l||27===l)return pe.focus(i),f(),!1;if(38===l||40===l)return d=c.find("a"),0!==d.length&&(g=d.index(m),h=38===l?-1===g-1?d.last():d.eq(g-1):g+1===d.length?d.eq(0):d.eq(g+1),i.attr("aria-activedescendent",h.parent().attr("id")),pe.focus(h)),!1}}else("click"===k||"vclick"===k||"touchstart"===k)&&(m.hasClass("al-option")||(m=m.parent()),j=m.find("span.al-value").html(),0===j.length&&(j=m.find("span.al-label").html()),i.val(j),pe.focus(i),f())}),pe.document.on("click vclick touchstart",function(b){c.hasClass("al-hide")||a(b.target).is(i)||f()})})},a("input[list]").datalist()}(jQuery);