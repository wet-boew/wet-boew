/*! HTML5 sessionStorage
 * @build		2009-08-20 23:35:12
 * @author		Andrea Giammarchi
 * @license	Mit Style License
 * @project	http://code.google.com/p/sessionstorage/
 */
"undefined"==typeof sessionStorage&&function(a){function b(){function b(){k.cookie=["sessionStorage="+a.encodeURIComponent(h=f.key(128))].join(";"),i=f.encode(h,i),g=new g(d,"name",d.name)}var e,k=(d.name,d.document),l=/\bsessionStorage\b=([^;]+)(;|$)/,m=l.exec(k.cookie);if(m){h=a.decodeURIComponent(m[1]),i=f.encode(h,i),g=new g(d,"name");for(var n=g.key(),e=0,o=n.length,p={};o>e;++e)0===(m=n[e]).indexOf(i)&&(j.push(m),p[m]=g.get(m),g.del(m));if(g=new g.constructor(d,"name",d.name),0<(this.length=j.length)){for(e=0,o=j.length,c=g.c,m=[];o>e;++e)m[e]=c.concat(g._c,g.escape(n=j[e]),c,c,(n=g.escape(p[n])).length,c,n);d.name+=m.join("")}}else b(),l.exec(k.cookie)||(j=null)}var d=a;try{for(;d!==d.top;)d=d.top}catch(e){}/** RC4 Stream Cipher
 *	http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html
 * -----------------------------------------------
 * @description	A quick stream cipher object able to encode
 *					or decode whatever string using
 *					a random key from lennght 1 to 256
 *
 * @author			this JavaScript porting by Andrea Giammarchi
 * @license		Mit Style License
 * @blog			http://webreflection.blogspot.com/
 * @version		1.1
 * @compatibility	hopefully every browser
 */
var f=function(a,b){return{decode:function(a,b){return this.encode(a,b)},encode:function(b,c){for(var d,e=b.length,f=c.length,g=[],h=[],i=0,j=0,k=0,l=0;256>i;++i)h[i]=i;for(i=0;256>i;++i)j=(j+(d=h[i])+b.charCodeAt(i%e))%256,h[i]=h[j],h[j]=d;for(j=0;f>k;++k)i=k%256,j=(j+(d=h[i]))%256,e=h[i]=h[j],h[j]=d,g[l++]=a(c.charCodeAt(k)^h[(e+d)%256]);return g.join("")},key:function(c){for(var d=0,e=[];c>d;++d)e[d]=a(1+(255*b()<<0));return e.join("")}}}(a.String.fromCharCode,a.Math.random),g=function(a){function b(a,b,c){this._i=(this._data=c||"").length,(this._key=b)?this._storage=a:(this._storage={_key:a||""},this._key="_key")}function c(a,b){var c=this.c;return c.concat(this._c,this.escape(a),c,c,(b=this.escape(b)).length,c,b)}return b.prototype.c=String.fromCharCode(1),b.prototype._c=".",b.prototype.clear=function(){this._storage[this._key]=this._data},b.prototype.del=function(a){var b=this.get(a);null!==b&&(this._storage[this._key]=this._storage[this._key].replace(c.call(this,a,b),""))},b.prototype.escape=a.escape,b.prototype.get=function(a){var b=this._storage[this._key],c=this.c,d=b.indexOf(a=c.concat(this._c,this.escape(a),c,c),this._i),e=null;return d>-1&&(d=b.indexOf(c,d+a.length-1)+1,e=b.substring(d,d=b.indexOf(c,d)),e=this.unescape(b.substr(++d,e))),e},b.prototype.key=function(){for(var a=this._storage[this._key],b=this.c,c=b+this._c,d=this._i,e=[],f=0,g=0;-1<(d=a.indexOf(c,d));)e[g++]=this.unescape(a.substring(d+=2,f=a.indexOf(b,d))),d=a.indexOf(b,f)+2,f=a.indexOf(b,d),d=1+f+1*a.substring(d,f);return e},b.prototype.set=function(a,b){this.del(a),this._storage[this._key]+=c.call(this,a,b)},b.prototype.unescape=a.unescape,b}(a);/** HTML5 sessionStorage cross-browser implementation
 * @description	sessionStorage object is an HTML5 working draft
 *					which aim is to remove cookie limits.
 *					Using a sort of "de-facto" standard as window.name
 *					behavior is, it is possible to implement the
 *					sessionStorage object in old browsers.
 *					The concept is that window.name persists in the tab,
 *					whatever page we are surfing, while as security measure
 *					I combined browser cookie management plus RC4 stream cipher
 *					in order to reduce security problems as much as possible.
 *
 * @author			Andrea Giammarchi
 * @license		Mit Style License
 * @blog			http://webreflection.blogspot.com/
 * @version		1.4
 * @compatibility	Android, Chrome, Explorer, Opera, unobtrusive for other browsers
 * @credits		W3 WebStorage Draft	http://dev.w3.org/html5/webstorage/
 *					RC4 Stream Cipher		http://www.wisdom.weizmann.ac.il/~itsik/RC4/rc4.html
 * @protocol		Linear String Storage, by the @author
 */
"[object Opera]"===Object.prototype.toString.call(a.opera)&&(history.navigationMode="compatible",g.prototype.escape=a.encodeURIComponent,g.prototype.unescape=a.decodeURIComponent),b.prototype={length:0,key:function(a){if("number"!=typeof a||0>a||j.length<=a)throw"Invalid argument";return j[a]},getItem:function(a){if(a=i+a,l.call(k,a))return k[a];var b=g.get(a);return null!==b&&(b=k[a]=f.decode(h,b)),b},setItem:function(a,b){this.removeItem(a),a=i+a,g.set(a,f.encode(h,k[a]=""+b)),this.length=j.push(a)},removeItem:function(a){var b=g.get(a=i+a);null!==b&&(delete k[a],g.del(a),this.length=j.remove(a))},clear:function(){g.clear(),k={},j.length=0}};var h,i=d.document.domain,j=[],k={},l=k.hasOwnProperty;j.remove=function(a){var b=this.indexOf(a);return b>-1&&this.splice(b,1),this.length},j.indexOf||(j.indexOf=function(a){for(var b=0,c=this.length;c>b;++b)if(this[b]===a)return b;return-1}),d.sessionStorage&&(b=function(){},b.prototype=d.sessionStorage),b=new b,null!==j&&(a.sessionStorage=b)}(window);