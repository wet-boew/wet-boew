<!DOCTYPE html>
<!--[if IE 7]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en" class="no-js">
<!--<![endif]-->
<head>
<meta charset="utf-8" />
<!-- Web Experience Toolkit (WET) / Boîte à outils de l'expérience Web (BOEW)
www.tbs.gc.ca/ws-nw/wet-boew/terms / www.sct.gc.ca/ws-nw/wet-boew/conditions -->
<title>Introduction to version 3.0 of the Web Experience Toolkit (WET)</title>

<link rel="shortcut icon" href="../build/theme-gcwu-fegc/images/favicon.ico" />
<meta name="description" content="English description / Description en anglais" />
<meta name="dcterms.creator" content="English name of the content author / Nom en anglais de l'auteur du contenu" />
<meta name="dcterms.title" content="English title / Titre en anglais" />
<meta name="dcterms.issued" title="W3CDTF" content="Date published (YYYY-MM-DD) / Date de publication (AAAA-MM-JJ)" />
<meta name="dcterms.modified" title="W3CDTF" content="Date modified (YYYY-MM-DD) / Date de modification (AAAA-MM-JJ)" />
<meta name="dcterms.subject" title="scheme" content="English subject terms / Termes de sujet en anglais" />
<meta name="dcterms.language" title="ISO639-2" content="eng" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<script src="../build/js/jquery.min.js"></script>
<link rel="stylesheet" href="../build/grids/css/util-min.css" />
<!--[if lte IE 8]>
<script src="../build/js/polyfills/html5shiv-min.js"></script>
<link rel="stylesheet" href="../build/js/css/pe-ap-ie-min.css" />
<link rel="stylesheet" href="../build/theme-gcwu-fegc/css/theme-ie-min.css" />
<![endif]-->
<!--[if gt IE 8]><!-->
<link rel="stylesheet" href="../build/js/css/pe-ap-min.css" />
<link rel="stylesheet" href="../build/theme-gcwu-fegc/css/theme-min.css" />
<!--<![endif]-->

<!-- CustomScriptsCSSStart -->
<!-- CustomScriptsCSSEnd -->
</head>

<body><div id="wb-body">
<div id="wb-skip">
<ul id="wb-tphp">
<li id="wb-skip1"><a href="#wb-cont">Skip to main content</a></li>
<li id="wb-skip2"><a href="#wb-nav">Skip to footer</a></li>
</ul>
</div>

<div id="wb-head"><div id="wb-head-in"><header>
<!-- HeaderStart -->
<nav role="navigation"><div id="gcwu-gcnb"><h2>Government of Canada navigation bar</h2><div id="gcwu-gcnb-in"><div id="gcwu-gcnb-fip">
<div id="gcwu-sig"><div id="gcwu-sig-in"><div id="gcwu-sig-eng" title="Government of Canada"><img src="../build/theme-gcwu-fegc/images/sig-eng.gif" width="214" height="20" alt="Government of Canada" /></div></div></div>
<ul>
<li id="gcwu-gcnb1"><a rel="external" href="http://www.canada.gc.ca/menu-eng.html">Canada.gc.ca</a></li>
<li id="gcwu-gcnb2"><a rel="external" href="http://www.servicecanada.gc.ca/eng/home.shtml">Services</a></li>
<li id="gcwu-gcnb3"><a rel="external" href="http://www.canada.gc.ca/aboutgov-ausujetgouv/depts/menu-eng.html">Departments</a></li>
<li id="gcwu-gcnb-lang"><a href="../demos/theme-gcwu-fegc/cont-fra.html" lang="fr">Français</a></li>
</ul>
</div></div></div></nav>

<div id="gcwu-bnr" role="banner"><div id="gcwu-bnr-in">
<div id="gcwu-wmms"><div id="gcwu-wmms-in"><div id="gcwu-wmms-fip" title="Symbol of the Government of Canada"><img src="../../build/theme-gcwu-fegc/images/wmms.gif" width="126" height="30" alt="Symbol of the Government of Canada" /></div></div></div>
<div id="gcwu-title"><p id="gcwu-title-in"><a href="index-eng.html">Web Experience Toolkit&#160;(WET)</a></p></div>

<section role="search"><div id="gcwu-srchbx"><h2>Search</h2>
<form action="#" method="post"><div id="gcwu-srchbx-in">
<label for="gcwu-srch">Search website</label><input id="gcwu-srch" name="gcwu-srch" type="search" value="" size="27" maxlength="150" />
<input id="gcwu-srch-submit" name="gcwu-srch-submit" type="submit" value="Search" data-icon="search" />
</div></form>
</div></section>
</div></div>

<nav role="navigation">
<div id="gcwu-psnb"><h2><span>Site</span> menu</h2><div id="gcwu-psnb-in"><div class="wet-boew-menubar mb-mega"><div>
<ul class="mb-menu" data-ajax-replace="../demos/includes/menu-eng.inc">
<li><div><a href="http://wet-boew.github.com/wet-boew/docs/index-eng.html">WET project</a></div></li>
<li><div><a href="section2/index-eng.html">Section 2</a></div></li>
<li><div><a href="#">Section 3</a></div></li>
<li><div><a href="#">Section 4</a></div></li>
<li><div><a href="#">Section 5</a></div></li>
<li><div><a href="#">Section 6</a></div></li>
<li><div><a href="#">Section 7</a></div></li>
</ul>
</div></div></div></div>

<div id="gcwu-bc"><h2>Breadcrumb trail</h2><div id="gcwu-bc-in">
<ol>
<li><a href="index-eng.html">Home</a></li>
<li>Introduction to version 3.0 of the Web Experience Toolkit (WET)</li>
</ol>
</div></div>
</nav>
<!-- HeaderEnd -->
</header></div></div>

<div id="wb-core"><div id="wb-core-in" class="equalize">
<div id="wb-main" role="main"><div id="wb-main-in">
<!-- MainContentStart -->
<h1 id="wb-cont">Introduction to version 3.0 of the Web Experience Toolkit (WET)</h1>

<p>Lessons learned from version 2.3, jQuery integration group is proud to annouce the next iteration of the WET jQuery framework release. This release was a complete re-write focusing on many
aspects from better development capabilites, cleaner plugin scope-ing, to more leveraging of components and dependencies.</p>

<section><h2>Approach</h2>

<section><h3>Mobile first</h3>
<p>Mobile devices are quickly gaining traction as a preferred information uptake tool for many users.  Recognizing this, we are trying to make our GOC web presence as mobile friendly as possible.
Optimizing page load times as well as minimizing the data consumption to the mobile customer’s browser will help cater to this new reality.  As most mobile customers have data plans with set amounts of “free” data, 
we want to ensure that they are not taking serious bites out of their data allotment just to view a couple of GOC web pages. We must also keep in mind that the recently popular tablets out there are for the most
part, technically mobile devices. </p>
</section>

<section><h3>Simpler calling system for plugins</h3>
<p>The goal of this new approach is to create a class based system to call in all plugins. This eliminates the param tag in the head section.  
This approach was the product of consistent feedback from the web editing community that it was awkward to work with the plugins since webmasters 
need to work on all parts of the HTML page (head, and body).  This is not a simple task for the many departments that have a CMS. 
Even though the plug-in architecture was easy to use, access to head portions of the page and nature of the plugins (page specific scope) made
 implementation cumbersome, process laden (having to make a request to update the CMS when a new plug-in was required) and restrictive 
 (had to wait for approvals and CMS updates thus delaying projects).</p>
</section>
 
<section>
<h3>CSS Standardization and optimization</h3>
<p>Looking forward, we know that the WET themes will change from time to time.  As you know, we have gone from CLF1 to CLF2 and now the new Usability theme
in just 5 years or so.  As you also know, each theme or template migration has been tedious and expensive.  This was in part due to the lack of standardization
of the associated CSS, more specifically to plugins since they are usually not part of a themes’ creation process more like an add-on.  This new PE approach
will make portability between WET themes much smoother.  Each plug-in now has a unique namespace prefixed with WET Framework such as “wet-boew-mediaplayer”.
This will ensure that there can be no duplication in class names and eliminate potential CSS conflicts or theme clashes.</p>

<p>With this new standardizing of the CSS involved in plug-in support,  we were now finally able to safely merged all plugins CSS into one file and minify which
eliminates the need for individual lib and support files for each plug-in, and give the CSS portion a significant performance boost due to file size reduction.
We are also exploring replacing file images with thier base64 encoding for more capable browsers, but still has fallback for ie6 to ie8.</p>
</section>
</section>

<section><h2>Changes from version 2.3</h2>
<section><h3>Removed URL ( 2056 Character ) parameter limitation</h3>

<p>Due to the nature of Javascript, the parameter passing mechanism employed by the current PE object uses the calling HTTP request for the actual 
plug-in file to pass the page specific parameters.  This is fine for smaller plugins that do not allow for a lot of custom parameters, but becomes
problematic when passing numerous or very long parameters.  
</p>
<p>A good example is the Rounded Corners page in the WET project;</p>

<ul>
 <li>Due to the nature of Javascript, the parameter passing mechanism employed by the current PE object uses the calling HTTP request for the actual plug-in file to pass the page specific parameters.  This is fine for smaller plugins that do not allow for a lot of custom parameters, but becomes problematic when passing numerous or very long parameters.</li>
 <li>Using Firebug and checking the Net properties, we will find the resource request to the wet-boew.corners.js file which is the rounded corners page top level plug-in script.</li>
 <li>It is more interesting to note the actual URL used to call the resource :  <code>http://alpha.gcwwwtemplates.tbs-sct.ircan.gc.ca/js/plugins/wet-boew.corners.js?p1=15px&div1=40px%2010px&li1=45px%2010px%2025px%2010px&div2=45px%2010px%2025px%2010px&div3=45px%2010px%2025px%2010px&img1=25px%2010px</code>.</li>
 <li>As you can see the old PE basically serialized the params variable in the PE.progress method and appended them to the calling URL ( which would still be true even if we used a more native jQuery.getScript() method ) to pass the page specific parameters to the plug-in.</li>
 <li>This approach became a bit problematic to some plug-ins (like the geo-map plug-in)  since this method of parameter passing is limited to the URI limit of 2056 characters.</li>
 <li>Additional, for developers,  this has proven to be an issue since they have to be conscious of not only the parameters values being  too long but also have to many of them for the plug-in they are developing.</li>
</ul>

<p>To that effect, the new class based approach enables parameter passing to the plug-in within the calling HTML element.  This creates a more symbiotic relationship between the HTML page and the plugin while better respecting the true nature of progressive enhancement.</p>
</section>

<section><h3>Location of PE on an (x)HTML(5) page</h3>

<p>The new PE object does not employ the progress method call in the head anymore.  Everything is handled by the PE file at the bottom of the page, since the HTML source above it what dictates what plug-in is executed
by the PE object. Interestingly enough you mentioned some challenges around the placement and visibility of other javascript resource files with this new approach.</p>
</section>
</section>

<section><h2>Features</h2>

<section><h3>Standardized dictionary</h3>
<p>In addition to trying to optimize the plug-in architecture, the use of terms and icons were also inconsistent and responsible for a large portion of code bloat and confusion to plug-in developers. 
To helps assure consistent text use/labelling for all plugins and in short decrease the time to market for plug-in developer ( not having to wrestle with correct text and translations ), the PE Object
offers a standardized dictionary. While it allows for plug developers to better ensure a consistent navigation and experience for the user, it also enables the GOC to better handle change management.</p>
</section>

<section><h3>i18n localization system</h3>
<p>Since the focus of version 3.0 is to attempt to reduce any unneccesary bloat, language file in version 2.3 were handled at the plug-in level. Although very modular in design the per plugin approach to language files
added extra code since it had to include both official language ( and a time more ) for each plug-ins' textual requirements. This created a bit more overhead in terms of mainteance since linguistic tweaks usually meant
a global scan of all the plugins to fix/patch any additions and/or corrections to terms used. Version 3.0 now sports a per language single file approach to ensure all textual components by plugins are in a central location.</p>
</section>

<section><h3>Create faster page responsivness</h3>
<p>As highlighted a few times, one of the main focuses for this new code re-engineering was to try to ensure the most responsive page response possible. We found that with only a few plugins active a simple webpage can request over 80 
http requests totalling about upwards to 1mb. While a portion of these requests were for the images and other supporting files for the webpage, it was interesting to note that upwards to 40% of those requests were from the current 
PE (v2.3) object ( javascript files for the plugins, their respective style sheets, and supporting images in those styles ).  Now due to the nature of having javascript in the head , you can see how this was causing a problem for 
people with lower end connection and even mobile devices. Javascript appended to the head and triggered in the head of a document,  will load synchronously and force your HTML content to wait until it has downloaded the files. By placing the
JS at the bottom of your page before the &lt;/body&gt; tag, you are allowing the HTML to be parsed prior to loading the javascript. This gives the effect of faster page load times.</p>
</section>
</section>

<section><h2>Benefits</h2>
<section><h3>Addressing some concerns about http thrashing</h3>
<p>One the major factors for the re-working of the  PE object, was the numerous concerns about the amount of HTTP requests and performance web users with  smaller bandwidth/pipleline allowances  for their internet. 
On lower speed, limited pipeline connections the amount of HTTP requests to a webpage become a crucial component in page responsiveness. As hinted above the old method with loading plug-in by plug-in in the head of
the document and all it resources ( css and images ), created quiet a load for lower bandwidth users, which prolonged “white screen” effect on any webpage/application that was WET enabled.</p>
</section>

<section><h3>Removing duplications in current PE Object</h3>
<p>The current plug-in architecture (v2.3) forces each plug-in has its own set of functions to a degree, and it’s own set of dedicated support and library files. It was observed that many plug-in developers would repeat
the same type of functionality( such as animations or fades ), by duplicating other plugins since the current PE system does not have a true integrated model that one plug-in to leverage code from the other. While these
duplicated functions may appear to do the same thing, they are often written very differently and some are more efficient than others. Our strategy this round was to leverage  the best and most efficient version of these
duplicated functions thus allowing all plugins to benefit from using the best version of each function. This will also help with consistency in the user experience as the fade or animation action will be the same across
all plugins. In the same breath, it will make change management much easier in that if a new, smoother or better way to create animation for example is discovered, we can apply that new method only once and all plugins
that leverage that function will benefit. This is much more simplified system than having to edit several javascript files that are associated with the various plugins that use this function.</p>
</section>

<section><h3>Eliminating the need for the <code>document.ready</code> function</h3>
<p>Exploring further into the real workings of how browsers render and interact with supporting files in a webpage, there was an interesting behaviour that we wanted to leverage for this new system. The <code>document.ready</code>
event can be a kind of hit and miss type of event across all browsers and in-order to ensure that we had things right. In trying to further optimize the PE approach, there was some work done to better understand the mechanics of when
the <code>document.ready</code> function was truly fired and just how consistent or inconsistent it was. It was discovered that the document.ready ( jQuery ) in order to be cross-browser compatible had to bind to either the 
<code>document.onreadystatechange</code> or <code>document.load</code> events which for the most part was only really triggered when all resources were downloaded. Since the PE system and it’s family of plugins was more
interested in the availability of the HTML on the page, then if image X was loaded or style Y was available, this was a seen a bit of wasted waiting from the PE’s perspective.</p>
<p>In addition to loss of time that the PE plugins are waiting for the “green” light, we were also concerned about the sheer number of plug-ins available to the WET framework, all together  there are about 58 plugins, and growing,
which all have attached their logic to the <code>document.ready</code> function. In order to introduce a more modular library, jQuery’s <code>document.ready</code> not only makes it easy to ensure that you can execute
on the document’s ready state, but also ensure that all function that are passed to it are stacked in a queue of sorts. This came as a concern since as the number of plugins increase, the current PE method, not only 
waits a bit longer to as mentioned earlier, but now has to spend time iterating through all the functions that was bound to the <code>document.ready</code> event. It was already having a negative effect on performance,
and would only get worse in time. The new PE system eliminates the dependency on event and function because it already has access to the HTML ( due to it position in the bottom of the body tag ). This has already started
to show a positive impact on page load and response.</p>
</section>

<section><h3>More CMS friendly</h3>
<p>In addition to more performing, we were also looking a implementation improvements since the focus of the WET platform is about ease of installation and scalability. As more and more GOC departments and agencies
move their web content to a CMS environment, there became a dislike with having the parameter tag  for the PE system situated in the head section of the page. Generally speaking, page-specific additions to the head
section is not very CMS friendly. This new class based approach gives web editors within a CMS environment the tools they need to modernize their pages while ensuring standardized mark-up. This class based approach gives
the web editors the freedom to use plugins in the content area of the webpage ( where for the most part they have unrestricted access to ) while ensuring proper mark-up, standards and best practices are followed. </p>
</section>
</section>

<section><h2>Additional information for potential interest</h2>

<p>Who else is using this type of method ( javascript on bottom )? (View the source code of these links)</p>
<ul>
<li><a href="http://www.google.ca">Google</a></li>
<li><a href="http://ca.yahoo.com">Yahoo</a></li>
</ul>
 
<p>Other interesting links<p>
<ul>
<li><a href="http://developer.yahoo.com/performance/rules.html#js_bottom">Best Practices for Speeding Up Your Web Site (Yahoo)</a></li>
<li><a href="http://stackoverflow.com/questions/1638670/javascript-at-bottom-top-of-web-page">JavaScript at bottom/top of web page? (Stackoverflow)</a></li>
<li><a href="http://nate.koechley.com/blog/2007/06/12/high-performance-web-sites/">"High Performance Web Sites" at the @media 2007 Conference in London</a></li>  
</ul>
</section>

<!-- <div class="grid-12">
    <div class="embedded-nav"> <a href="#embedded" class="span-3 align-center">Available plugins</a> <a href="#embedded" class="span-5 align-center">Plugin - Style Guide</a> <a href="#embedded" class="span-3 align-center">Roadmap</a> </div>
</div> -->
<div class="clear"></div>

<dl id="gcwu-date-mod" role="contentinfo">
<dt>Date modified:</dt><dd><span><time>2011-10-31</time></span></dd>
</dl>
<div class="clear"></div>
<!-- MainContentEnd -->
</div></div>
</div></div>

<div id="wb-foot"><div id="wb-foot-in"><footer><h2 id="wb-nav">Footer</h2>
<!-- FooterStart -->
<nav role="navigation"><div id="gcwu-sft"><h3>Site footer</h3><div id="gcwu-sft-in">
<div id="gcwu-tctr">
<ul>
<li class="gcwu-tc"><a href="#" rel="license">Terms and conditions</a></li>
<li class="gcwu-tr"><a href="#">Transparency</a></li>
</ul>
</div>
<div class="clear"></div>
<section><div class="span-2"><h4 class="gcwu-col-head"><a href="#">About us</a></h4>
<ul>
<li><a href="#">Our Mandate</a></li>
<li><a href="#">Our Minister</a></li>
</ul>
</div></section>
<section><div class="span-2"><h4 class="gcwu-col-head"><a href="#">News</a></h4>
<ul>
<li><a href="#">News releases</a></li>
<li><a href="#">Media advisories</a></li>
<li><a href="#">Multimedia</a></li>
</ul>
</div></section>
<section><div class="span-2"><h4 class="gcwu-col-head"><a href="#">Contact us</a></h4>
<address>
<ul>
<li><a href="#">Phone numbers</a></li>
<li><a href="#">Office locations</a></li>
</ul>
</address>
</div></section>
<section><div class="span-2"><h4 class="gcwu-col-head"><a href="#">Stay connected</a></h4>
<ul>
<li><a rel="external" href="#">YouTube</a></li>
<li><a rel="external" href="#">Twitter</a></li>
<li><a href="#">Feeds</a></li>
</ul>
</div></section>
</div></div></nav>

<nav role="navigation"><div id="gcwu-gcft"><h3>Government of Canada footer</h3><div id="gcwu-gcft-in"><div id="gcwu-gcft-fip">
<ul>
<li><a rel="external" href="http://healthycanadians.gc.ca/index-eng.php"><span>Health</span><br />healthycanadians.gc.ca</a></li>
<li><a rel="external" href="http://www.voyage.gc.ca/index-eng.asp"><span>Travel</span><br />travel.gc.ca</a></li>
<li><a rel="external" href="http://www.servicecanada.gc.ca/eng/home.shtml"><span>Service Canada</span><br />servicecanada.gc.ca</a></li>
<li><a rel="external" href="http://www.jobbank.gc.ca/intro-eng.aspx"><span>Jobs</span><br />jobbank.gc.ca</a></li>
<li><a rel="external" href="http://actionplan.gc.ca/eng/index.asp"><span>Economy</span><br />actionplan.gc.ca</a></li>
<li id="gcwu-gcft-ca"><div><a rel="external" href="http://www.canada.gc.ca/menu-eng.html">Canada.gc.ca</a></div></li>
</ul>
</div></div></div></nav>
<!-- FooterEnd -->
</footer>
</div></div></div>

<!-- ScriptsStart -->
<script src="../build/theme-gcwu-fegc/js/theme-min.js"></script>
<script src="../build/js/settings.js"></script>
<script src="../build/js/pe-ap-min.js"></script>
<!-- ScriptsEnd -->
</body>
</html>