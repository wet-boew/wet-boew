/*
  WET-BOEW
  @title: Details/summary polyfill pre-Modernizr CSS
 */

summary {
	// Make sure summary remains visible
	display: list-item !important;
	list-style-type: none; // Prevent list bullets from appearing in browsers that lack native details/summary support (e.g. IE/Edge)
	list-style-type: disclosure-closed; // Show summary arrows in Firefox 49.0+ and future versions of Blink/Webkit
	visibility: visible !important;
}

%details-nested-in-hidden-details {
	details {
		summary {
			display: none !important;
		}
	}
}

%summary-goodies {
	color: $link-color;
	text-decoration: inherit;
}

%summary-heading-goodies {
	margin-bottom: 0;
	margin-top: 0;
}

/*
TODOS:
-Give the placeholder selectors better names
-Are any of the extends below unnecessary? Not sure if I might be overdoing it and duplicating stuff at lower levels than what's actually needed
*/

details {
	margin-bottom: .25em;

	summary {
		@extend %summary-goodies;
		border: 1px solid #ddd;
		border-radius: 4px;
		padding: 5px 15px;

		&,
		&.h2,
		&.h3,
		&.h4,
		&.h5,
		&.h6 {
			@extend %summary-goodies;
			@extend %summary-heading-goodies;
		}

		&.summary-title {
			@extend %summary-goodies;
			@extend h3;
			@extend %summary-heading-goodies;

			h2,
			h4,
			h5,
			h6 {
				@extend h3;
				@extend %summary-goodies;
			}
		}

		&:focus,
		&:hover {
			background-color: transparent;
			color: $link-hover-color;
			text-decoration: underline;
		}

		&:focus {
			outline-style: dotted;
			outline-width: 1px;
		}
	}

	&[open] {
		border: 1px solid #ddd;
		border-radius: 4px;

		> {
			summary {
				border: 0;
				border-bottom: 1px solid #ddd;
				border-bottom-left-radius: 0;
				border-bottom-right-radius: 0;
				list-style-type: disclosure-open;
				margin-bottom: .25em;
			}
		}
	}

	// Prevent FOUC
	&:not([open]) {
		@extend %details-nested-in-hidden-details;
		visibility: hidden;

		> {
			// Need details and * to deal with specificity issues
			details,
			* {
				display: none;
			}
		}
	}

	&.alert {
		&:not([open]) {
			visibility: visible;
		}
	}

	.out {
		@extend %details-nested-in-hidden-details;
	}
}

.tabpanels {
	> {
		details {
			&:not([open]) {
				visibility: visible;
			}
		}
	}
}

// Prevent FOUC when polyfill is disabled
.wb-disable {
	details {
		visibility: visible !important;

		> {
			*:not(summary) {
				display: block !important;
			}
		}
	}
}
